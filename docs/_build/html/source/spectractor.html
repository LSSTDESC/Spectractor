

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>spectractor package &mdash; Spectractor 1.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'1.1',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Spectractor
          

          
          </a>

          
            
            
              <div class="version">
                1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">spectractor package</a><ul>
<li><a class="reference internal" href="#subpackages">Subpackages</a></li>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-spectractor.config">spectractor.config module</a></li>
<li><a class="reference internal" href="#module-spectractor.logbook">spectractor.logbook module</a></li>
<li><a class="reference internal" href="#module-spectractor.parameters">spectractor.parameters module</a></li>
<li><a class="reference internal" href="#module-spectractor.tools">spectractor.tools module</a></li>
<li><a class="reference internal" href="#module-spectractor">Module contents</a></li>
</ul>
</li>
</ul>
</div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Spectractor</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>spectractor package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/source/spectractor.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="spectractor-package">
<h1>spectractor package<a class="headerlink" href="#spectractor-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="spectractor.extractor.html">spectractor.extractor package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="spectractor.extractor.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="spectractor.extractor.html#module-spectractor.extractor.dispersers">spectractor.extractor.dispersers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spectractor.extractor.html#module-spectractor.extractor.extractor">spectractor.extractor.extractor module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spectractor.extractor.html#module-spectractor.extractor.images">spectractor.extractor.images module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spectractor.extractor.html#module-spectractor.extractor.psf">spectractor.extractor.psf module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spectractor.extractor.html#module-spectractor.extractor.spectroscopy">spectractor.extractor.spectroscopy module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spectractor.extractor.html#module-spectractor.extractor.spectrum">spectractor.extractor.spectrum module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spectractor.extractor.html#module-spectractor.extractor.targets">spectractor.extractor.targets module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spectractor.extractor.html#module-spectractor.extractor">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="spectractor.fit.html">spectractor.fit package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="spectractor.fit.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="spectractor.fit.html#module-spectractor.fit.fitter">spectractor.fit.fitter module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spectractor.fit.html#module-spectractor.fit.statistics">spectractor.fit.statistics module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spectractor.fit.html#module-spectractor.fit">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="spectractor.simulation.html">spectractor.simulation package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="spectractor.simulation.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="spectractor.simulation.html#module-spectractor.simulation.image_simulation">spectractor.simulation.image_simulation module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spectractor.simulation.html#module-spectractor.simulation.libradtran">spectractor.simulation.libradtran module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spectractor.simulation.html#module-spectractor.simulation.simulator">spectractor.simulation.simulator module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spectractor.simulation.html#module-spectractor.simulation.throughput">spectractor.simulation.throughput module</a></li>
<li class="toctree-l2"><a class="reference internal" href="spectractor.simulation.html#module-spectractor.simulation">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-spectractor.config">
<span id="spectractor-config-module"></span><h2>spectractor.config module<a class="headerlink" href="#module-spectractor.config" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="spectractor.config.load_config">
<code class="descclassname">spectractor.config.</code><code class="descname">load_config</code><span class="sig-paren">(</span><em>config_filename</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/config.html#load_config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.config.load_config" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="spectractor.config.set_logger">
<code class="descclassname">spectractor.config.</code><code class="descname">set_logger</code><span class="sig-paren">(</span><em>logger</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/config.html#set_logger"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.config.set_logger" title="Permalink to this definition">¶</a></dt>
<dd><p>Logger function for all classes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>logger</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Name of the class, usually self.__class__.__name__</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>my_logger</strong> – Logging object</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/logging.html#module-logging" title="(in Python v3.7)">logging</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Test</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">my_logger</span> <span class="o">=</span> <span class="n">set_logger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">log</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">my_logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;This info test function works.&#39;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">my_logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;This debug test function works.&#39;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">my_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;This warning test function works.&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span> <span class="o">=</span> <span class="n">Test</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-spectractor.logbook">
<span id="spectractor-logbook-module"></span><h2>spectractor.logbook module<a class="headerlink" href="#module-spectractor.logbook" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="spectractor.logbook.LogBook">
<em class="property">class </em><code class="descclassname">spectractor.logbook.</code><code class="descname">LogBook</code><span class="sig-paren">(</span><em>logbook='ctiofulllogbook_jun2017_v5.csv'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/logbook.html#LogBook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.logbook.LogBook" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Class to load_image and analyse observation logbook csv files.</p>
<dl class="method">
<dt id="spectractor.logbook.LogBook.plot_columns_vs_date">
<code class="descname">plot_columns_vs_date</code><span class="sig-paren">(</span><em>column_names</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/logbook.html#LogBook.plot_columns_vs_date"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.logbook.LogBook.plot_columns_vs_date" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot of the column property with respect to the dates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>column_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – List of column names to plot versus time from the log book.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">logbook</span> <span class="o">=</span> <span class="n">LogBook</span><span class="p">(</span><span class="s1">&#39;./ctiofulllogbook_jun2017_v5.csv&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logbook</span><span class="o">.</span><span class="n">plot_columns_vs_date</span><span class="p">([</span><span class="s1">&#39;seeing&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logbook</span><span class="o">.</span><span class="n">plot_columns_vs_date</span><span class="p">([</span><span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="spectractor.logbook.LogBook.search_for_image">
<code class="descname">search_for_image</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/logbook.html#LogBook.search_for_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.logbook.LogBook.search_for_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Look for an image file name in the logbook and load_image properties:
* Obj-posXpix and Obj-posYpix: the [x0,y0] guessed pixel position in the image
* Dx and Dy: the x and y windows in pixel to search for the target; set XWINDOW and YWINDOW variables</p>
<blockquote>
<div>in parameters.py</div></blockquote>
<ul class="simple">
<li>object: the name of the target</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – the fits image file name (not the path, only the file name.)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>disperser_label</strong> (<em>str</em>) – the name of the disperser</li>
<li><strong>target</strong> (<em>str</em>) – the name of the target</li>
<li><strong>xpos</strong> (<em>int</em>) – the x position of the target (in pixel)</li>
<li><strong>ypos</strong> (<em>int</em>) – the y position of the target (in pixel)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">logbook</span> <span class="o">=</span> <span class="n">LogBook</span><span class="p">(</span><span class="s1">&#39;./ctiofulllogbook_jun2017_v5.csv&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">disperser_label</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">xpos</span><span class="p">,</span> <span class="n">ypos</span> <span class="o">=</span> <span class="n">logbook</span><span class="o">.</span><span class="n">search_for_image</span><span class="p">(</span><span class="s2">&quot;unknown_file.fits&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">disperser_label</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">xpos</span><span class="p">,</span> <span class="n">ypos</span><span class="p">)</span>
<span class="go">None None None None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">disperser_label</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">xpos</span><span class="p">,</span> <span class="n">ypos</span> <span class="o">=</span> <span class="n">logbook</span><span class="o">.</span><span class="n">search_for_image</span><span class="p">(</span><span class="s2">&quot;reduc_20170605_028.fits&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">disperser_label</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">xpos</span><span class="p">,</span> <span class="n">ypos</span><span class="p">)</span>
<span class="go">HoloPhAg PNG321.0+3.9 814 585</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">disperser_label</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">xpos</span><span class="p">,</span> <span class="n">ypos</span> <span class="o">=</span> <span class="n">logbook</span><span class="o">.</span><span class="n">search_for_image</span><span class="p">(</span><span class="s2">&quot;reduc_20170608_119.fits&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">disperser_label</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">xpos</span><span class="p">,</span> <span class="n">ypos</span><span class="p">)</span>
<span class="go">None HD205905 None None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">disperser_label</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">xpos</span><span class="p">,</span> <span class="n">ypos</span> <span class="o">=</span> <span class="n">logbook</span><span class="o">.</span><span class="n">search_for_image</span><span class="p">(</span><span class="s2">&quot;reduc_20170630_001.fits&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">disperser_label</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">xpos</span><span class="p">,</span> <span class="n">ypos</span><span class="p">)</span>
<span class="go">None bias None None</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-spectractor.parameters">
<span id="spectractor-parameters-module"></span><h2>spectractor.parameters module<a class="headerlink" href="#module-spectractor.parameters" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-spectractor.tools">
<span id="spectractor-tools-module"></span><h2>spectractor.tools module<a class="headerlink" href="#module-spectractor.tools" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="spectractor.tools.LevMarLSQFitterWithNan">
<em class="property">class </em><code class="descclassname">spectractor.tools.</code><code class="descname">LevMarLSQFitterWithNan</code><a class="reference internal" href="../_modules/spectractor/tools.html#LevMarLSQFitterWithNan"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.LevMarLSQFitterWithNan" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">astropy.modeling.fitting.LevMarLSQFitter</span></code></p>
<dl class="method">
<dt id="spectractor.tools.LevMarLSQFitterWithNan.objective_function">
<code class="descname">objective_function</code><span class="sig-paren">(</span><em>fps</em>, <em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#LevMarLSQFitterWithNan.objective_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.LevMarLSQFitterWithNan.objective_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to minimize.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fps</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – parameters returned by the fitter</li>
<li><strong>args</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – [model, [weights], [input coordinates]]</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="spectractor.tools.clean_target_spikes">
<code class="descclassname">spectractor.tools.</code><code class="descname">clean_target_spikes</code><span class="sig-paren">(</span><em>data</em>, <em>saturation</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#clean_target_spikes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.clean_target_spikes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="spectractor.tools.detect_peaks">
<code class="descclassname">spectractor.tools.</code><code class="descname">detect_peaks</code><span class="sig-paren">(</span><em>image</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#detect_peaks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.detect_peaks" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes an image and detect the peaks using the local maximum filter.
Returns a boolean mask of the peaks (i.e. 1 when
the pixel’s value is the neighborhood maximum, 0 otherwise).
Only positive peaks are detected (take absolute value or negative value of the
image to detect the negative ones).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image</strong> (<em>array_like</em>) – The image 2D array.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>detected_peaks</strong> – Boolean maskof the peaks.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array_like</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im</span><span class="p">[</span><span class="mi">49</span><span class="p">,</span><span class="mi">49</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">detected_peaks</span> <span class="o">=</span> <span class="n">detect_peaks</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">detected_peaks</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="ow">not</span> <span class="n">detected_peaks</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">detected_peaks</span><span class="p">[</span><span class="mi">49</span><span class="p">,</span><span class="mi">49</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="spectractor.tools.dichotomie">
<code class="descclassname">spectractor.tools.</code><code class="descname">dichotomie</code><span class="sig-paren">(</span><em>f</em>, <em>a</em>, <em>b</em>, <em>epsilon</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#dichotomie"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.dichotomie" title="Permalink to this definition">¶</a></dt>
<dd><p>Dichotomie method to find a function root.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>f</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#callable" title="(in Python v3.7)"><em>callable</em></a>) – The function</li>
<li><strong>a</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Left bound to the expected root</li>
<li><strong>b</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Right bound to the expected root</li>
<li><strong>epsilon</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Precision</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>root</strong> – The root of the function.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)">float</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>Search for the Gaussian FWHM:
&gt;&gt;&gt; p = [1,0,1]
&gt;&gt;&gt; xx = np.arange(-10,10,0.1)
&gt;&gt;&gt; PSF = gauss(xx, <a href="#id1"><span class="problematic" id="id2">*</span></a>p)
&gt;&gt;&gt; def eq(x):
…     return np.interp(x, xx, PSF) - 0.5
&gt;&gt;&gt; root = dichotomie(eq, 0, 10, 1e-6)
&gt;&gt;&gt; assert np.isclose(2*root, 2.355*p[2], 1e-3)</p>
</dd></dl>

<dl class="function">
<dt id="spectractor.tools.ensure_dir">
<code class="descclassname">spectractor.tools.</code><code class="descname">ensure_dir</code><span class="sig-paren">(</span><em>directory_name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#ensure_dir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.ensure_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensure that <em>directory_name</em> directory exists. If not, create it.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>directory_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – The directory name.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ensure_dir</span><span class="p">(</span><span class="s1">&#39;tests&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">&#39;tests&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ensure_dir</span><span class="p">(</span><span class="s1">&#39;tests/mytest&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">&#39;tests/mytest&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">rmdir</span><span class="p">(</span><span class="s1">&#39;./tests/mytest&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="spectractor.tools.extract_info_from_CTIO_header">
<code class="descclassname">spectractor.tools.</code><code class="descname">extract_info_from_CTIO_header</code><span class="sig-paren">(</span><em>obj</em>, <em>header</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#extract_info_from_CTIO_header"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.extract_info_from_CTIO_header" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="spectractor.tools.fftconvolve_gaussian">
<code class="descclassname">spectractor.tools.</code><code class="descname">fftconvolve_gaussian</code><span class="sig-paren">(</span><em>array</em>, <em>reso</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#fftconvolve_gaussian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.fftconvolve_gaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>Convolve an 1D or 2D array with a Gaussian profile of given standard deviation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array</strong> (<a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.7)"><em>array</em></a>) – The array to convolve.</li>
<li><strong>reso</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – The standard deviation of the Gaussian profile.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>convolved</strong> – The convolved array, same size and shape as input.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.7)">array</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">fftconvolve_gaussian</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span>
<span class="go">[ 0.5         0.63114657  0.74850168]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">fftconvolve_gaussian</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="mi">3</span><span class="p">])</span>
<span class="go">[ 0.5         0.63114657  0.74850168]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">fftconvolve_gaussian</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="spectractor.tools.filter_stars_from_bgd">
<code class="descclassname">spectractor.tools.</code><code class="descname">filter_stars_from_bgd</code><span class="sig-paren">(</span><em>data</em>, <em>margin_cut=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#filter_stars_from_bgd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.filter_stars_from_bgd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="spectractor.tools.find_nearest">
<code class="descclassname">spectractor.tools.</code><code class="descname">find_nearest</code><span class="sig-paren">(</span><em>array</em>, <em>value</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#find_nearest"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.find_nearest" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the nearest index and value in an array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array</strong> (<a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.7)"><em>array</em></a>) – The array to inspect.</li>
<li><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – The value to look for.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>index</strong> (<em>int</em>) – The array index of the nearest value close to <em>value</em></li>
<li><strong>val</strong> (<em>float</em>) – The value fo the array at index.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">10.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="n">find_nearest</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">3.3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
<span class="go">3 3.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="spectractor.tools.fit_gauss">
<code class="descclassname">spectractor.tools.</code><code class="descname">fit_gauss</code><span class="sig-paren">(</span><em>x, y, guess=[10, 1000, 1], bounds=(-inf, inf), sigma=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#fit_gauss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.fit_gauss" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit a Gaussian profile to data, using curve_fit. The mean guess value of the Gaussian
must not be far from the truth values. Boundaries helps a lot also.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>np.array</em>) – The x data values.</li>
<li><strong>y</strong> (<em>np.array</em>) – The y data values.</li>
<li><strong>guess</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a><em>, </em><em>[</em><a class="reference internal" href="spectractor.extractor.html#spectractor.extractor.psf.PSF2D.amplitude" title="spectractor.extractor.psf.PSF2D.amplitude"><em>amplitude</em></a><em>, </em><em>mean</em><em>, </em><em>sigma</em><em>]</em><em>, </em><em>optional</em>) – List of first guessed values for the Gaussian fit (default: [10, 1000, 1]).</li>
<li><strong>bounds</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a><em>, </em><em>optional</em>) – List of boundaries for the parameters [[minima],[maxima]] (default: (-np.inf, np.inf)).</li>
<li><strong>sigma</strong> (<em>np.array</em><em>, </em><em>optional</em>) – The y data uncertainties.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>popt</strong> (<em>list</em>) – Best fitting parameters of curve_fit.</li>
<li><strong>pcov</strong> (<em>list</em>) – Best fitting parameters covariance matrix from curve_fit.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">600.</span><span class="p">,</span><span class="mf">700.</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">650</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">gauss</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">p</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">25</span><span class="p">])</span>
<span class="go">10.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">guess</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">630</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">fit_gauss</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">guess</span><span class="o">=</span><span class="n">guess</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">100</span><span class="p">,</span><span class="mi">700</span><span class="p">,</span><span class="mi">100</span><span class="p">)),</span> <span class="n">sigma</span><span class="o">=</span><span class="n">y_err</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">popt</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="spectractor.tools.fit_gauss2d_outlier_removal">
<code class="descclassname">spectractor.tools.</code><code class="descname">fit_gauss2d_outlier_removal</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>z</em>, <em>sigma=3.0</em>, <em>niter=3</em>, <em>guess=None</em>, <em>bounds=None</em>, <em>circular=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#fit_gauss2d_outlier_removal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.fit_gauss2d_outlier_removal" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Fit an astropy Gaussian 2D model with parameters :</dt>
<dd>amplitude, x_mean,y_mean,x_stddev, y_stddev,theta</dd>
</dl>
<p>using outlier removal methods.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>np.array</em>) – 2D array of the x coordinates from meshgrid.</li>
<li><strong>y</strong> (<em>np.array</em>) – 2D array of the y coordinates from meshgrid.</li>
<li><strong>z</strong> (<em>np.array</em>) – the 2D array image.</li>
<li><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – value of sigma for the sigma rejection of outliers (default: 3)</li>
<li><strong>niter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – maximum number of iterations for the outlier detection (default: 3)</li>
<li><strong>guess</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a><em>, </em><em>optional</em>) – List containing a first guess for the PSF parameters (default: None).</li>
<li><strong>bounds</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a><em>, </em><em>optional</em>) – 2D list containing bounds for the PSF parameters with format ((min,…), (max…)) (default: None)</li>
<li><strong>circular</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, force the Gaussian shape to be circular (default: False)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>fitted_model</strong> – Astropy Gaussian2D model</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Fittable</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.modeling</span> <span class="k">import</span> <span class="n">models</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[:</span><span class="mi">50</span><span class="p">,:</span><span class="mi">50</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PSF</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Gaussian2D</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Z</span> <span class="o">=</span> <span class="n">PSF</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="o">*</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>..plot:</dt>
<dd>plt.imshow(Z, origin=’loxer’) #doctest: +ELLIPSIS
plt.show()</dd>
</dl>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">guess</span> <span class="o">=</span> <span class="p">(</span><span class="mi">45</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">),</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">90</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit</span> <span class="o">=</span> <span class="n">fit_gauss2d_outlier_removal</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">guess</span><span class="o">=</span><span class="n">guess</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span> <span class="n">circular</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">fit</span><span class="o">.</span><span class="n">param_names</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="go">[50.0, 25.0, 25.0, 5.0, 5.0, 0.0]</span>
</pre></div>
</div>
<dl class="docutils">
<dt>..plot:</dt>
<dd>plt.imshow(Z-fit(X, Y), origin=’loxer’) #doctest: +ELLIPSIS
&lt;matplotlib.image.AxesImage object at 0x…&gt;
plt.show()</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="spectractor.tools.fit_moffat1d">
<code class="descclassname">spectractor.tools.</code><code class="descname">fit_moffat1d</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>guess=None</em>, <em>bounds=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#fit_moffat1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.fit_moffat1d" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Fit an astropy Moffat 1D model with parameters :</dt>
<dd>amplitude, x_mean, gamma, alpha</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>np.array</em>) – 1D array of the x coordinates from meshgrid.</li>
<li><strong>y</strong> (<em>np.array</em>) – the 1D array amplitudes.</li>
<li><strong>guess</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a><em>, </em><em>optional</em>) – List containing a first guess for the PSF parameters (default: None).</li>
<li><strong>bounds</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a><em>, </em><em>optional</em>) – 2D list containing bounds for the PSF parameters with format ((min,…), (max…)) (default: None)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>fitted_model</strong> – Astropy Moffat1D model</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Fittable</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.modeling</span> <span class="k">import</span> <span class="n">models</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PSF</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Moffat1D</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span> <span class="o">=</span> <span class="n">PSF</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">*</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>..plot:</dt>
<dd>plt.imshow(Z, origin=’loxer’)
plt.show()</dd>
</dl>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">guess</span> <span class="o">=</span> <span class="p">(</span><span class="mi">45</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit</span> <span class="o">=</span> <span class="n">fit_moffat1d</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">guess</span><span class="o">=</span><span class="n">guess</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">fit</span><span class="o">.</span><span class="n">param_names</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="mf">1e-6</span><span class="p">)))</span>
</pre></div>
</div>
<dl class="docutils">
<dt>..plot:</dt>
<dd>plt.imshow(Z-fit(X, Y), origin=’loxer’)
plt.show()</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="spectractor.tools.fit_moffat1d_outlier_removal">
<code class="descclassname">spectractor.tools.</code><code class="descname">fit_moffat1d_outlier_removal</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>sigma=3.0</em>, <em>niter=3</em>, <em>guess=None</em>, <em>bounds=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#fit_moffat1d_outlier_removal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.fit_moffat1d_outlier_removal" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Fit an astropy Moffat 1D model with parameters :</dt>
<dd>amplitude, x_mean, gamma, alpha</dd>
</dl>
<p>using outlier removal methods.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>np.array</em>) – 1D array of the x coordinates from meshgrid.</li>
<li><strong>y</strong> (<em>np.array</em>) – the 1D array amplitudes.</li>
<li><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – value of sigma for the sigma rejection of outliers (default: 3)</li>
<li><strong>niter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – maximum number of iterations for the outlier detection (default: 3)</li>
<li><strong>guess</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a><em>, </em><em>optional</em>) – List containing a first guess for the PSF parameters (default: None).</li>
<li><strong>bounds</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a><em>, </em><em>optional</em>) – 2D list containing bounds for the PSF parameters with format ((min,…), (max…)) (default: None)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>fitted_model</strong> – Astropy Moffat1D model</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Fittable</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.modeling</span> <span class="k">import</span> <span class="n">models</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PSF</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Moffat1D</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span> <span class="o">=</span> <span class="n">PSF</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">*</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>..plot:</dt>
<dd>plt.imshow(Z, origin=’loxer’)
plt.show()</dd>
</dl>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">guess</span> <span class="o">=</span> <span class="p">(</span><span class="mi">45</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit</span> <span class="o">=</span> <span class="n">fit_moffat1d_outlier_removal</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">guess</span><span class="o">=</span><span class="n">guess</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span> <span class="n">niter</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">fit</span><span class="o">.</span><span class="n">param_names</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="mf">1e-6</span><span class="p">)))</span>
</pre></div>
</div>
<dl class="docutils">
<dt>..plot:</dt>
<dd>plt.imshow(Z-fit(X, Y), origin=’loxer’)
plt.show()</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="spectractor.tools.fit_moffat2d_outlier_removal">
<code class="descclassname">spectractor.tools.</code><code class="descname">fit_moffat2d_outlier_removal</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>z</em>, <em>sigma=3.0</em>, <em>niter=3</em>, <em>guess=None</em>, <em>bounds=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#fit_moffat2d_outlier_removal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.fit_moffat2d_outlier_removal" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Fit an astropy Moffat 2D model with parameters :</dt>
<dd>amplitude, x_mean, y_mean, gamma, alpha</dd>
</dl>
<p>using outlier removal methods.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>np.array</em>) – 2D array of the x coordinates from meshgrid.</li>
<li><strong>y</strong> (<em>np.array</em>) – 2D array of the y coordinates from meshgrid.</li>
<li><strong>z</strong> (<em>np.array</em>) – the 2D array image.</li>
<li><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – value of sigma for the sigma rejection of outliers (default: 3)</li>
<li><strong>niter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – maximum number of iterations for the outlier detection (default: 3)</li>
<li><strong>guess</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a><em>, </em><em>optional</em>) – List containing a first guess for the PSF parameters (default: None).</li>
<li><strong>bounds</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a><em>, </em><em>optional</em>) – 2D list containing bounds for the PSF parameters with format ((min,…), (max…)) (default: None)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>fitted_model</strong> – Astropy Moffat2D model</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Fittable</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.modeling</span> <span class="k">import</span> <span class="n">models</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[:</span><span class="mi">100</span><span class="p">,:</span><span class="mi">100</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PSF</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Moffat2D</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Z</span> <span class="o">=</span> <span class="n">PSF</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="o">*</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>..plot:</dt>
<dd>plt.imshow(Z, origin=’loxer’)
plt.show()</dd>
</dl>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">guess</span> <span class="o">=</span> <span class="p">(</span><span class="mi">45</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit</span> <span class="o">=</span> <span class="n">fit_moffat2d_outlier_removal</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">guess</span><span class="o">=</span><span class="n">guess</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span> <span class="n">niter</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">fit</span><span class="o">.</span><span class="n">param_names</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">)))</span>
</pre></div>
</div>
<dl class="docutils">
<dt>..plot:</dt>
<dd>plt.imshow(Z-fit(X, Y), origin=’loxer’)
plt.show()</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="spectractor.tools.fit_multigauss_and_bgd">
<code class="descclassname">spectractor.tools.</code><code class="descname">fit_multigauss_and_bgd</code><span class="sig-paren">(</span><em>x, y, guess=[0, 1, 10, 1000, 1, 0], bounds=(-inf, inf), sigma=None, fix_centroids=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#fit_multigauss_and_bgd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.fit_multigauss_and_bgd" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit a multiple Gaussian profile plus a polynomial background to data, using iminuit.
The mean guess value of the Gaussian must not be far from the truth values.
Boundaries helps a lot also. The degree of the polynomial background is fixed by parameters.CALIB_BGD_NPARAMS.
The order of the parameters is a first block CALIB_BGD_NPARAMS parameters (from high to low monomial terms,
same as np.polyval), and then block of 3 parameters for the Gaussian profiles like amplitude, mean and standard
deviation. x values are renormalised on the [-1, 1] interval for the background.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.7)"><em>array</em></a>) – The x data values.</li>
<li><strong>y</strong> (<a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.7)"><em>array</em></a>) – The y data values.</li>
<li><strong>guess</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a><em>, </em><em>[</em><em>CALIB_BGD_ORDER+1 parameters</em><em>, </em><em>3*number of Gaussian parameters</em><em>]</em>) – List of first guessed values for the Gaussian fit (default: [0, 1, 10, 1000, 1]).</li>
<li><strong>bounds</strong> (<a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.7)"><em>array</em></a>) – List of boundaries for the parameters [[minima],[maxima]] (default: (-np.inf, np.inf)).</li>
<li><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.7)"><em>array</em></a><em>, </em><em>optional</em>) – The uncertainties on the y values (default: None).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>popt</strong> (<em>array</em>) – Best fitting parameters of curve_fit.</li>
<li><strong>pcov</strong> (<em>array</em>) – Best fitting parameters covariance matrix from curve_fit.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">600.</span><span class="p">,</span><span class="mf">800.</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">650</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">multigauss_and_bgd</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">p</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">{y[0]:.2f}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="go">19.00</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">err</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">guess</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">640</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">750</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span> <span class="o">=</span> <span class="p">((</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">800</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">800</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">fit_multigauss_and_bgd</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">guess</span><span class="o">=</span><span class="n">guess</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">err</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">popt</span><span class="p">,</span><span class="n">rtol</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit</span> <span class="o">=</span> <span class="n">multigauss_and_bgd</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">popt</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>..plot:</dt>
<dd>import matplotlib.pyplot as plt
plt.errorbar(x,y,yerr=err,linestyle=’None’)
plt.plot(x,fit,’r-‘)
plt.plot(x,multigauss_and_bgd(x, <a href="#id3"><span class="problematic" id="id4">*</span></a>guess),’k–’)
plt.show()</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="spectractor.tools.fit_multigauss_and_line">
<code class="descclassname">spectractor.tools.</code><code class="descname">fit_multigauss_and_line</code><span class="sig-paren">(</span><em>x, y, guess=[0, 1, 10, 1000, 1, 0], bounds=(-inf, inf)</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#fit_multigauss_and_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.fit_multigauss_and_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit a multiple Gaussian profile plus a straight line to data, using curve_fit.
The mean guess value of the Gaussian must not be far from the truth values.
Boundaries helps a lot also. The order of the parameters is line slope, line intercept,
and then block of 3 parameters for the Gaussian profiles like amplitude, mean and standard
deviation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.7)"><em>array</em></a>) – The x data values.</li>
<li><strong>y</strong> (<a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.7)"><em>array</em></a>) – The y data values.</li>
<li><strong>guess</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a><em>, </em><em>[</em><em>slope</em><em>, </em><em>intercept</em><em>, </em><a class="reference internal" href="spectractor.extractor.html#spectractor.extractor.psf.PSF2D.amplitude" title="spectractor.extractor.psf.PSF2D.amplitude"><em>amplitude</em></a><em>, </em><em>mean</em><em>, </em><em>sigma</em><em>]</em>) – List of first guessed values for the Gaussian fit (default: [0, 1, 10, 1000, 1]).</li>
<li><strong>bounds</strong> (<em>2D-list</em>) – List of boundaries for the parameters [[minima],[maxima]] (default: (-np.inf, np.inf)).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>popt</strong> (<em>list</em>) – Best fitting parameters of curve_fit.</li>
<li><strong>pcov</strong> (<em>2D-list</em>) – Best fitting parameters covariance matrix from curve_fit.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">600.</span><span class="p">,</span><span class="mf">800.</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">multigauss_and_line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">650</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">610.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span> <span class="o">=</span> <span class="p">((</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">800</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">800</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">fit_multigauss_and_line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">guess</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">630</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">770</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">popt</span><span class="p">)</span>
<span class="go">[   1.   10.   20.  650.    3.   40.  750.   10.]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="spectractor.tools.fit_poly1d">
<code class="descclassname">spectractor.tools.</code><code class="descname">fit_poly1d</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>order</em>, <em>w=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#fit_poly1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.fit_poly1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit a 1D polynomial function to data. Use np.polyfit.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.7)"><em>array</em></a>) – The x data values.</li>
<li><strong>y</strong> (<a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.7)"><em>array</em></a>) – The y data values.</li>
<li><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – The degree of the polynomial function.</li>
<li><strong>w</strong> (<a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.7)"><em>array</em></a><em>, </em><em>optional</em>) – Weights on the y data (default: None).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>fit</strong> (<em>array</em>) – The best fitting parameter values.</li>
<li><strong>cov</strong> (<em>2D-array</em>) – The covariance matrix</li>
<li><strong>model</strong> (<em>array</em>) – The best fitting profile</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">500.</span><span class="p">,</span> <span class="mf">1000.</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit</span><span class="p">,</span> <span class="n">cov</span><span class="p">,</span> <span class="n">model</span> <span class="o">=</span> <span class="n">fit_poly1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">fit</span><span class="p">,</span> <span class="mf">1e-5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">cov</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit</span><span class="p">,</span> <span class="n">cov2</span><span class="p">,</span> <span class="n">model2</span> <span class="o">=</span> <span class="n">fit_poly1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">err</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">fit</span><span class="p">,</span> <span class="mf">1e-5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit</span><span class="p">,</span> <span class="n">cov3</span><span class="p">,</span> <span class="n">model3</span> <span class="o">=</span> <span class="n">fit_poly1d</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">err</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
<span class="go">[0 0 0 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="spectractor.tools.fit_poly1d_legendre">
<code class="descclassname">spectractor.tools.</code><code class="descname">fit_poly1d_legendre</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>order</em>, <em>w=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#fit_poly1d_legendre"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.fit_poly1d_legendre" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit a 1D polynomial function to data using Legendre polynomial orthogonal basis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.7)"><em>array</em></a>) – The x data values.</li>
<li><strong>y</strong> (<a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.7)"><em>array</em></a>) – The y data values.</li>
<li><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – The degree of the polynomial function.</li>
<li><strong>w</strong> (<a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.7)"><em>array</em></a><em>, </em><em>optional</em>) – Weights on the y data (default: None).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>fit</strong> (<em>array</em>) – The best fitting parameter values.</li>
<li><strong>cov</strong> (<em>2D-array</em>) – The covariance matrix</li>
<li><strong>model</strong> (<em>array</em>) – The best fitting profile</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">500.</span><span class="p">,</span> <span class="mf">1000.</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">1e-6</span><span class="p">,</span> <span class="o">-</span><span class="mf">1e-4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit</span><span class="p">,</span> <span class="n">cov</span><span class="p">,</span> <span class="n">model</span> <span class="o">=</span> <span class="n">fit_poly1d_legendre</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">fit</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit</span><span class="p">,</span> <span class="n">cov2</span><span class="p">,</span> <span class="n">model2</span> <span class="o">=</span> <span class="n">fit_poly1d_legendre</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">w</span><span class="o">=</span><span class="n">err</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">fit</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit</span><span class="p">,</span> <span class="n">cov3</span><span class="p">,</span> <span class="n">model3</span> <span class="o">=</span> <span class="n">fit_poly1d</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">err</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
<span class="go">[0 0 0 0]</span>
</pre></div>
</div>
<dl class="docutils">
<dt>..plot:</dt>
<dd>import matplotlib.pyplot as plt
plt.errorbar(x,y,yerr=err,fmt=’ro’)
plt.plot(x,model2)
plt.show()</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="spectractor.tools.fit_poly1d_outlier_removal">
<code class="descclassname">spectractor.tools.</code><code class="descname">fit_poly1d_outlier_removal</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>order=2</em>, <em>sigma=3.0</em>, <em>niter=3</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#fit_poly1d_outlier_removal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.fit_poly1d_outlier_removal" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit a 1D polynomial function to data. Use astropy.modeling.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.7)"><em>array</em></a>) – The x data values.</li>
<li><strong>y</strong> (<a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.7)"><em>array</em></a>) – The y data values.</li>
<li><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – The degree of the polynomial function (default: 2).</li>
<li><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Value of the sigma-clipping (default: 3.0).</li>
<li><strong>niter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – The number of iterations to converge (default: 3).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>model</strong> (<em>Astropy model</em>) – The best fitting astropy model.</li>
<li><strong>outliers</strong> (<em>array_like</em>) – List of the outlier points.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">500.</span><span class="p">,</span> <span class="mf">1000.</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="p">[::</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">,</span> <span class="n">outliers</span> <span class="o">=</span> <span class="n">fit_poly1d_outlier_removal</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">sigma</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">c0</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
<span class="go">0.00</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">c1</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
<span class="go">1.00</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">c2</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
<span class="go">2.00</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">c3</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
<span class="go">3.00</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="spectractor.tools.fit_poly2d">
<code class="descclassname">spectractor.tools.</code><code class="descname">fit_poly2d</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>z</em>, <em>order</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#fit_poly2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.fit_poly2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit a 2D polynomial function to data. Use astropy.modeling.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.7)"><em>array</em></a>) – The x data values.</li>
<li><strong>y</strong> (<a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.7)"><em>array</em></a>) – The y data values.</li>
<li><strong>z</strong> (<a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.7)"><em>array</em></a>) – The z data values.</li>
<li><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – The degree of the polynomial function.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>model</strong> – The best fitting astropy polynomial model</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Astropy model</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[:</span><span class="mi">50</span><span class="p">,:</span><span class="mi">50</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit</span> <span class="o">=</span> <span class="n">fit_poly2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">c0_0</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">c1_0</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">c2_0</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">c0_1</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">c0_2</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">c1_1</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="spectractor.tools.fit_poly2d_outlier_removal">
<code class="descclassname">spectractor.tools.</code><code class="descname">fit_poly2d_outlier_removal</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>z</em>, <em>order=2</em>, <em>sigma=3.0</em>, <em>niter=30</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#fit_poly2d_outlier_removal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.fit_poly2d_outlier_removal" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit a 2D polynomial function to data. Use astropy.modeling.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.7)"><em>array</em></a>) – The x data values.</li>
<li><strong>y</strong> (<a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.7)"><em>array</em></a>) – The y data values.</li>
<li><strong>z</strong> (<a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.7)"><em>array</em></a>) – The z data values.</li>
<li><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – The degree of the polynomial function (default: 2).</li>
<li><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Value of the sigma-clipping (default: 3.0).</li>
<li><strong>niter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – The number of iterations to converge (default: 30).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>model</strong> – The best fitting astropy model.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Astropy model</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[:</span><span class="mi">50</span><span class="p">,:</span><span class="mi">50</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span><span class="p">[::</span><span class="mi">10</span><span class="p">,::</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit</span> <span class="o">=</span> <span class="n">fit_poly2d_outlier_removal</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">sigma</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">c0_0</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">c1_0</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">c2_0</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">c0_1</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">c0_2</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">c1_1</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="spectractor.tools.formatting_numbers">
<code class="descclassname">spectractor.tools.</code><code class="descname">formatting_numbers</code><span class="sig-paren">(</span><em>value</em>, <em>error_high</em>, <em>error_low</em>, <em>std=None</em>, <em>label=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#formatting_numbers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.formatting_numbers" title="Permalink to this definition">¶</a></dt>
<dd><p>Format a physical value and its uncertainties. Round the uncertainties
to the first significant digit, and do the same for the physical value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – The physical value.</li>
<li><strong>error_high</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Upper uncertainty.</li>
<li><strong>error_low</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Lower uncertainty</li>
<li><strong>std</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – The RMS of the physical parameter (default: None).</li>
<li><strong>label</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em>, </em><em>optional</em>) – The name of the physical parameter to output (default: None).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>text</strong> – The formatted output strings inside a tuple.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)">tuple</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">formatting_numbers</span><span class="p">(</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">0.789</span><span class="p">,</span> <span class="mf">0.500</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="go">(&#39;test&#39;, &#39;3.0&#39;, &#39;0.8&#39;, &#39;0.5&#39;, &#39;0.5&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">formatting_numbers</span><span class="p">(</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.008</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="go">(&#39;test&#39;, &#39;3.000&#39;, &#39;0.07&#39;, &#39;0.008&#39;, &#39;0.03&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">formatting_numbers</span><span class="p">(</span><span class="mf">3240.</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="go">(&#39;3240.0&#39;, &#39;0.2&#39;, &#39;0.4&#39;, &#39;0.3&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">formatting_numbers</span><span class="p">(</span><span class="mf">3240.</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">420</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="mi">330</span><span class="p">)</span>
<span class="go">(&#39;3240&#39;, &#39;230&#39;, &#39;420&#39;, &#39;330&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">formatting_numbers</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.008</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="mf">0.03</span><span class="p">)</span>
<span class="go">(&#39;0.000&#39;, &#39;0.008&#39;, &#39;0.040&#39;, &#39;0.030&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">formatting_numbers</span><span class="p">(</span><span class="o">-</span><span class="mi">55</span><span class="p">,</span> <span class="mf">0.008</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="mf">0.03</span><span class="p">)</span>
<span class="go">(&#39;-55.000&#39;, &#39;0.008&#39;, &#39;0.04&#39;, &#39;0.03&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="spectractor.tools.from_lambda_to_colormap">
<code class="descclassname">spectractor.tools.</code><code class="descname">from_lambda_to_colormap</code><span class="sig-paren">(</span><em>lambdas</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#from_lambda_to_colormap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.from_lambda_to_colormap" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="spectractor.tools.gauss">
<code class="descclassname">spectractor.tools.</code><code class="descname">gauss</code><span class="sig-paren">(</span><em>x</em>, <em>A</em>, <em>x0</em>, <em>sigma</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#gauss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.gauss" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the Gaussian function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>array_like</em>) – Abscisse array to evaluate the function of size Nx.</li>
<li><strong>A</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Amplitude of the Gaussian function.</li>
<li><strong>x0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Mean of the Gaussian function.</li>
<li><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Standard deviation of the Gaussian function.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>m</strong> – The Gaussian function evaluated on the x array.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array_like</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">gauss</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(50,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span>
<span class="go">10.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="spectractor.tools.gauss_jacobian">
<code class="descclassname">spectractor.tools.</code><code class="descname">gauss_jacobian</code><span class="sig-paren">(</span><em>x</em>, <em>A</em>, <em>x0</em>, <em>sigma</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#gauss_jacobian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.gauss_jacobian" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Jacobian matrix of the Gaussian function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>array_like</em>) – Abscisse array to evaluate the function of size Nx.</li>
<li><strong>A</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Amplitude of the Gaussian function.</li>
<li><strong>x0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Mean of the Gaussian function.</li>
<li><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Standard deviation of the Gaussian function.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>m</strong> – The Jacobian matrix of size 3 x Nx.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array_like</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jac</span> <span class="o">=</span> <span class="n">gauss_jacobian</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">jac</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(50, 3)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="spectractor.tools.hessian_and_theta">
<code class="descclassname">spectractor.tools.</code><code class="descname">hessian_and_theta</code><span class="sig-paren">(</span><em>data</em>, <em>margin_cut=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#hessian_and_theta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.hessian_and_theta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="spectractor.tools.line">
<code class="descclassname">spectractor.tools.</code><code class="descname">line</code><span class="sig-paren">(</span><em>x</em>, <em>a</em>, <em>b</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.line" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="spectractor.tools.load_fits">
<code class="descclassname">spectractor.tools.</code><code class="descname">load_fits</code><span class="sig-paren">(</span><em>file_name</em>, <em>hdu_index=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#load_fits"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.load_fits" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="spectractor.tools.multigauss_and_bgd">
<code class="descclassname">spectractor.tools.</code><code class="descname">multigauss_and_bgd</code><span class="sig-paren">(</span><em>x</em>, <em>*params</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#multigauss_and_bgd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.multigauss_and_bgd" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiple Gaussian profile plus a polynomial background to data.
Polynomial function is based on the orthogonal Legendre polynomial basis.
The degree of the polynomial background is fixed by parameters.CALIB_BGD_NPARAMS.
The order of the parameters is a first block CALIB_BGD_NPARAMS parameters (from low to high Legendre polynome degree,
contrary to np.polyval), and then block of 3 parameters for the Gaussian profiles like amplitude, mean and standard
deviation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.7)"><em>array</em></a>) – The x data values.</li>
<li><strong>*params</strong> (<em>list of float parameters as described above.</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>y</strong> – The y profile values.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.7)">array</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">parameters</span><span class="o">.</span><span class="n">CALIB_BGD_NPARAMS</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">600.</span><span class="p">,</span> <span class="mf">800.</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">650</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">multigauss_and_bgd</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">p</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">{y[0]:.2f}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="go">19.00</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../source/spectractor-1.py">Source code</a>)</p>
<div class="figure">
<img alt="../_images/spectractor-1.png" src="../_images/spectractor-1.png" />
</div>
</dd></dl>

<dl class="function">
<dt id="spectractor.tools.multigauss_and_bgd_jacobian">
<code class="descclassname">spectractor.tools.</code><code class="descname">multigauss_and_bgd_jacobian</code><span class="sig-paren">(</span><em>x</em>, <em>*params</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#multigauss_and_bgd_jacobian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.multigauss_and_bgd_jacobian" title="Permalink to this definition">¶</a></dt>
<dd><p>Jacobien of the multiple Gaussian profile plus a polynomial background to data.
The degree of the polynomial background is fixed by parameters.CALIB_BGD_NPARAMS.
The order of the parameters is a first block CALIB_BGD_NPARAMS parameters (from low to high Legendre polynome degree,
contrary to np.polyval), and then block of 3 parameters for the Gaussian profiles like amplitude, mean and standard
deviation. x values are renormalised on the [-1, 1] interval for the background.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.7)"><em>array</em></a>) – The x data values.</li>
<li><strong>*params</strong> (<em>list of float parameters as described above.</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>y</strong> – The jacobian values.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.7)">array</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">spectractor.parameters</span> <span class="k">as</span> <span class="nn">parameters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parameters</span><span class="o">.</span><span class="n">CALIB_BGD_NPARAMS</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">600.</span><span class="p">,</span><span class="mf">800.</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">650</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">multigauss_and_bgd_jacobian</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">p</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x</span><span class="p">))))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(200, 10)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="spectractor.tools.multigauss_and_line">
<code class="descclassname">spectractor.tools.</code><code class="descname">multigauss_and_line</code><span class="sig-paren">(</span><em>x</em>, <em>*params</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#multigauss_and_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.multigauss_and_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiple Gaussian profile plus a straight line to data.
The order of the parameters is line slope, line intercept,
and then block of 3 parameters for the Gaussian profiles like amplitude, mean and standard
deviation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.7)"><em>array</em></a>) – The x data values.</li>
<li><strong>*params</strong> (<em>list of float parameters as described above.</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>y</strong> – The y profile values.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.7)">array</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">600.</span><span class="p">,</span><span class="mf">800.</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">multigauss_and_line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">650</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">610.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="spectractor.tools.pixel_rotation">
<code class="descclassname">spectractor.tools.</code><code class="descname">pixel_rotation</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>theta</em>, <em>x0=0</em>, <em>y0=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#pixel_rotation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.pixel_rotation" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate a 2D vector (x,y) of an angle theta clockwise.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – x coordinate</li>
<li><strong>y</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – y coordinate</li>
<li><strong>theta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – angle in radians</li>
<li><strong>x0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – x position of the center of rotation (default: 0)</li>
<li><strong>y0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – y position of the center of rotation (default: 0)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>u</strong> (<em>float</em>) – rotated x coordinate</li>
<li><strong>v</strong> (<em>float</em>) – rotated y coordinate</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pixel_rotation</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">45</span><span class="p">)</span>
<span class="go">(0.0, 0.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">pixel_rotation</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">pixel_rotation</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="spectractor.tools.plot_image_simple">
<code class="descclassname">spectractor.tools.</code><code class="descname">plot_image_simple</code><span class="sig-paren">(</span><em>ax</em>, <em>data</em>, <em>scale='lin'</em>, <em>title=''</em>, <em>units='Image units'</em>, <em>cmap=None</em>, <em>target_pixcoords=None</em>, <em>vmin=None</em>, <em>vmax=None</em>, <em>aspect=None</em>, <em>cax=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#plot_image_simple"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.plot_image_simple" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple function to plot a spectrum with error bars and labels.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ax</strong> (<em>Axes</em>) – Axes instance to make the plot</li>
<li><strong>data</strong> (<em>array_like</em>) – The image data 2D array.</li>
<li><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Scaling of the image (choose between: lin, log or log10) (default: lin)</li>
<li><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Title of the image (default: “”)</li>
<li><strong>units</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Units of the image to be written in the color bar label (default: “Image units”)</li>
<li><strong>cmap</strong> (<em>colormap</em>) – Color map label (default: None)</li>
<li><strong>target_pixcoords</strong> (<em>array_like</em><em>, </em><em>optional</em>) – 2D array  giving the (x,y) coordinates of the targets on the image: add a scatter plot (default: None)</li>
<li><strong>vmin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Minimum value of the image (default: None)</li>
<li><strong>vmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Maximum value of the image (default: None)</li>
<li><strong>aspect</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Aspect keyword to be passed to imshow (default: None)</li>
<li><strong>cax</strong> (<em>Axes</em><em>, </em><em>optional</em>) – Color bar axes if necessary (default: None).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spectractor.extractor.images</span> <span class="k">import</span> <span class="n">Image</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="s1">&#39;tests/data/reduc_20170605_028.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_image_simple</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">im</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s2">&quot;log10&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;ADU&quot;</span><span class="p">,</span> <span class="n">target_pixcoords</span><span class="o">=</span><span class="p">(</span><span class="mi">815</span><span class="p">,</span><span class="mi">580</span><span class="p">),</span>
<span class="gp">... </span>                    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;tests/data/reduc_20170605_028.fits&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">parameters</span><span class="o">.</span><span class="n">DISPLAY</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="spectractor.tools.plot_spectrum_simple">
<code class="descclassname">spectractor.tools.</code><code class="descname">plot_spectrum_simple</code><span class="sig-paren">(</span><em>ax</em>, <em>lambdas</em>, <em>data</em>, <em>data_err=None</em>, <em>xlim=None</em>, <em>color='r'</em>, <em>label=''</em>, <em>title=''</em>, <em>units=''</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#plot_spectrum_simple"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.plot_spectrum_simple" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple function to plot a spectrum with error bars and labels.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ax</strong> (<em>Axes</em>) – Axes instance to make the plot</li>
<li><strong>xlim</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a><em>, </em><em>optional</em>) – List of minimum and maximum abscisses</li>
<li><strong>color</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – String for the color of the spectrum (default: ‘r’)</li>
<li><strong>label</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – String label for the plot legend</li>
<li><strong>lambdas</strong> (<a class="reference external" href="https://docs.python.org/3/library/array.html#module-array" title="(in Python v3.7)"><em>array</em></a><em>, </em><em>optional</em>) – The wavelengths array if it has been given externally (default: None)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spectractor.extractor.spectrum</span> <span class="k">import</span> <span class="n">Spectrum</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">Spectrum</span><span class="p">(</span><span class="n">file_name</span><span class="o">=</span><span class="s1">&#39;tests/data/reduc_20170605_028_spectrum.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_spectrum_simple</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">lambdas</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">data_err</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">err</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">500</span><span class="p">,</span><span class="mi">700</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">parameters</span><span class="o">.</span><span class="n">DISPLAY</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="spectractor.tools.rescale_x_for_legendre">
<code class="descclassname">spectractor.tools.</code><code class="descname">rescale_x_for_legendre</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#rescale_x_for_legendre"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.rescale_x_for_legendre" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="spectractor.tools.save_fits">
<code class="descclassname">spectractor.tools.</code><code class="descname">save_fits</code><span class="sig-paren">(</span><em>file_name</em>, <em>header</em>, <em>data</em>, <em>overwrite=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#save_fits"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.save_fits" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="spectractor.tools.tied_circular_gauss2d">
<code class="descclassname">spectractor.tools.</code><code class="descname">tied_circular_gauss2d</code><span class="sig-paren">(</span><em>g1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#tied_circular_gauss2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.tied_circular_gauss2d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="spectractor.tools.wavelength_to_rgb">
<code class="descclassname">spectractor.tools.</code><code class="descname">wavelength_to_rgb</code><span class="sig-paren">(</span><em>wavelength</em>, <em>gamma=0.8</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#wavelength_to_rgb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.wavelength_to_rgb" title="Permalink to this definition">¶</a></dt>
<dd><p>taken from <a class="reference external" href="http://www.noah.org/wiki/Wavelength_to_RGB_in_Python">http://www.noah.org/wiki/Wavelength_to_RGB_in_Python</a>
This converts a given wavelength of light to an
approximate RGB color value. The wavelength must be given
in nanometers in the range from 380 nm through 750 nm
(789 THz through 400 THz).</p>
<p>Based on code by Dan Bruton
<a class="reference external" href="http://www.physics.sfasu.edu/astro/color/spectra.html">http://www.physics.sfasu.edu/astro/color/spectra.html</a>
Additionally alpha value set to 0.5 outside range</p>
</dd></dl>

<dl class="function">
<dt id="spectractor.tools.weighted_avg_and_std">
<code class="descclassname">spectractor.tools.</code><code class="descname">weighted_avg_and_std</code><span class="sig-paren">(</span><em>values</em>, <em>weights</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spectractor/tools.html#weighted_avg_and_std"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spectractor.tools.weighted_avg_and_std" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the weighted average and standard deviation.</p>
<p>values, weights – Numpy ndarrays with the same shape.</p>
<p>For example for the PSF</p>
<p>x=pixel number
y=Intensity in pixel</p>
<p>values-x
weights=y=f(x)</p>
</dd></dl>

</div>
<div class="section" id="module-spectractor">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-spectractor" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Jeremy Neveu

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>